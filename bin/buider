#!/usr/bin/env php
<?php
include __DIR__.'/../vendor/autoload.php';

$config = require __DIR__.'/../config/console.config.php';
try {
    $moduleManager = new Rindow\Container\ModuleManager($config);
    $app = $moduleManager->getServiceLocator()->get('Rindow\\Console\\Command\\DefaultDispatcher');
    $app->run('Rindow\\Packagist',$argv);
} catch(\Exception $e) {
    while(true) {
        echo 'Exception: '.get_class($e)."\n";
        echo $e->getMessage()."(".$e->getCode().")\n";
        echo "Source: ".$e->getFile()."(".$e->getLine().")\n";
        echo "Stack Trace:\n";
        echo $e->getTraceAsString()."\n";
        $e = $e->getPrevious();
        if($e==null)
            break;
        echo "##### Previous Exception ####\n";
    }
}
